{"version":3,"sources":["../../src/common/encrypt.js"],"names":["passwordEncryptionLogic","verifyUserPassword","concatStr","salt","secretKey","baseConverter","username","pwd","joinedStr","Buffer","from","toString","baseConverted","bcrypt","hashSync","dbPwd","pwdMerge","compareSync"],"mappings":";;;;;;QAwBgBA,uB,GAAAA,uB;QAYAC,kB,GAAAA,kB;;AApChB;;;;;;AAEA,IAAMC,YAAY,KAAlB;AAAA,IACEC,OAAO,EADT;;AAGO,IAAMC,gCAAY,gCAAlB;;AAEP;;;;;;AAMA,SAASC,aAAT,CAAuBC,QAAvB,EAAiCC,GAAjC,EAAsC;AACpC,MAAMC,iBAAeF,QAAf,GAA0BJ,SAA1B,GAAsCK,GAA5C;AACA,SAAOE,OAAOC,IAAP,CAAYF,SAAZ,EAAuBG,QAAvB,CAAgC,QAAhC,CAAP;AACD;;AAED;;;;;;AAMO,SAASX,uBAAT,CAAiCM,QAAjC,EAA2CC,GAA3C,EAAgD;AACrD,MAAMK,gBAAgBP,cAAcC,QAAd,EAAwBC,GAAxB,CAAtB;AACA,SAAOM,mBAAOC,QAAP,CAAgBF,aAAhB,EAA+BT,IAA/B,CAAP;AACD;;AAED;;;;;;;AAOO,SAASF,kBAAT,CAA4BK,QAA5B,EAAsCC,GAAtC,EAA2CQ,KAA3C,EAAkD;AACvD,MAAMC,WAAWX,cAAcC,QAAd,EAAwBC,GAAxB,CAAjB;AACA,SAAOM,mBAAOI,WAAP,CAAmBD,QAAnB,EAA6BD,KAA7B,CAAP;AACD","file":"encrypt.js","sourcesContent":["import bcrypt from \"bcryptjs\";\r\n\r\nconst concatStr = \"$-$\",\r\n  salt = 10;\r\n\r\nexport const secretKey = \"$any_rangom_key_as_per_choice$\";\r\n\r\n/**\r\n * custom logic for first level of encryption\r\n * @param {string} username\r\n * @param {string} pwd\r\n * @returns {string}\r\n */\r\nfunction baseConverter(username, pwd) {\r\n  const joinedStr = `${username}${concatStr}${pwd}`;\r\n  return Buffer.from(joinedStr).toString(\"base64\");\r\n}\r\n\r\n/**\r\n * Logic to encrypt the password\r\n * @param {string} username\r\n * @param {string} pwd\r\n * @returns {string}\r\n */\r\nexport function passwordEncryptionLogic(username, pwd) {\r\n  const baseConverted = baseConverter(username, pwd);\r\n  return bcrypt.hashSync(baseConverted, salt);\r\n}\r\n\r\n/**\r\n * verifies password\r\n * @param {string} username\r\n * @param {string} pwd\r\n * @param {string} dbPwd\r\n * @returns {boolean}\r\n */\r\nexport function verifyUserPassword(username, pwd, dbPwd) {\r\n  const pwdMerge = baseConverter(username, pwd);\r\n  return bcrypt.compareSync(pwdMerge, dbPwd);\r\n}"]}